<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–ª—É–± –≤–µ–¥—å–º - –í–µ–¥—å–º—ã –Ω–µ —Å—Ç–∞—Ä–µ—é—Ç</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
        }

        header {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 0 20px rgba(139, 0, 139, 0.6);
        }

        .admin-btn {
            padding: 10px 20px;
            background: rgba(100, 150, 255, 0.3);
            border: 1px solid rgba(100, 150, 255, 0.5);
            border-radius: 8px;
            color: #6496FF;
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-btn:hover {
            background: rgba(100, 150, 255, 0.5);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .hero {
            text-align: center;
            margin-bottom: 60px;
        }

        .hero h1 {
            font-size: 48px;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(139, 0, 139, 0.6);
        }

        .hero p {
            font-size: 18px;
            color: #aaa;
            margin-bottom: 30px;
        }

        .hero-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, rgba(0, 200, 100, 0.4) 0%, rgba(100, 150, 255, 0.4) 100%);
            color: #00FF88;
            border: 1px solid rgba(0, 255, 100, 0.4);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, rgba(0, 200, 100, 0.6) 0%, rgba(100, 150, 255, 0.6) 100%);
            box-shadow: 0 0 20px rgba(0, 255, 100, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 150, 0, 0.3);
            color: #FFB800;
            border: 1px solid rgba(255, 150, 0, 0.4);
        }

        .btn-secondary:hover {
            background: rgba(255, 150, 0, 0.5);
        }

        .section {
            margin-bottom: 60px;
        }

        .section-title {
            font-size: 32px;
            margin-bottom: 30px;
            text-align: center;
            text-shadow: 0 0 20px rgba(139, 0, 139, 0.4);
        }

        .members-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .member-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .member-card:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(100, 150, 255, 0.5);
            box-shadow: 0 0 20px rgba(100, 150, 255, 0.2);
            transform: translateY(-5px);
        }

        .member-emoji {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .member-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .member-title {
            color: #FFD700;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .member-bio {
            color: #aaa;
            font-size: 13px;
            line-height: 1.4;
        }

        .form-section {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 40px;
            max-width: 600px;
            margin: 0 auto;
        }

        .form-title {
            font-size: 28px;
            margin-bottom: 10px;
            text-align: center;
        }

        .form-subtitle {
            color: #aaa;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            font-family: inherit;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #6496FF;
            background: rgba(100, 150, 255, 0.1);
            box-shadow: 0 0 10px rgba(100, 150, 255, 0.3);
        }

        input::placeholder, textarea::placeholder {
            color: #888;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }

        .form-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-submit {
            background: linear-gradient(135deg, rgba(0, 200, 100, 0.4) 0%, rgba(100, 150, 255, 0.4) 100%);
            color: #00FF88;
            border: 1px solid rgba(0, 255, 100, 0.4);
        }

        .btn-submit:hover:not(:disabled) {
            background: linear-gradient(135deg, rgba(0, 200, 100, 0.6) 0%, rgba(100, 150, 255, 0.6) 100%);
            box-shadow: 0 0 20px rgba(0, 255, 100, 0.3);
        }

        .btn-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-reset {
            background: rgba(255, 100, 100, 0.2);
            color: #FF6B6B;
            border: 1px solid rgba(255, 100, 100, 0.4);
        }

        .btn-reset:hover {
            background: rgba(255, 100, 100, 0.3);
        }

        .success-message {
            display: none;
            background: rgba(0, 200, 100, 0.2);
            border: 1px solid rgba(0, 255, 100, 0.4);
            color: #00FF88;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .error-message {
            display: none;
            background: rgba(255, 100, 100, 0.2);
            border: 1px solid rgba(255, 100, 100, 0.4);
            color: #FF6B6B;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .required {
            color: #FF6B6B;
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #aaa;
            font-size: 14px;
        }

        .toggle-form-btn {
            display: block;
            margin: 30px auto;
            padding: 12px 30px;
            background: rgba(100, 150, 255, 0.3);
            border: 1px solid rgba(100, 150, 255, 0.5);
            border-radius: 8px;
            color: #6496FF;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-form-btn:hover {
            background: rgba(100, 150, 255, 0.5);
        }

        .form-hidden {
            display: none;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">üßô‚Äç‚ôÄÔ∏è –í–µ–¥—å–º—ã –Ω–µ —Å—Ç–∞—Ä–µ—é—Ç</div>
        <a href="/admin/login" class="admin-btn">üîê –ê–¥–º–∏–Ω–∫–∞</a>
    </header>

    <div class="container">
        <div class="hero">
            <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∫–ª—É–± –≤–µ–¥—å–º! üåô‚ú®</h1>
            <p>–ú–µ—Å—Ç–æ, –≥–¥–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —Å–∞–º—ã–µ –≤–æ–ª—à–µ–±–Ω—ã–µ –∂–µ–Ω—â–∏–Ω—ã –Ω–∞—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</p>
            <div class="hero-buttons">
                <button class="btn btn-primary" onclick="scrollToForm()">üìù –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
                <a href="#members" class="btn btn-secondary">üë• –£—á–∞—Å—Ç–Ω–∏—Ü—ã</a>
            </div>
        </div>

        <div class="section" id="members">
            <h2 class="section-title">üë• –ù–∞—à–∏ —É—á–∞—Å—Ç–Ω–∏—Ü—ã</h2>
            <div class="members-grid" id="membersContainer">
                <div style="text-align: center; color: #aaa; grid-column: 1 / -1;">
                    ‚è≥ –ó–∞–≥—Ä—É–∂–∞—é —É—á–∞—Å—Ç–Ω–∏—Ü...
                </div>
            </div>
        </div>

        <button class="toggle-form-btn" id="toggleFormBtn" onclick="toggleForm()">üìù –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∞–Ω–∫–µ—Ç—É</button>

        <div class="section form-hidden" id="formSection">
            <div class="form-section">
                <h2 class="form-title">üßô‚Äç‚ôÄÔ∏è –ê–Ω–∫–µ—Ç–∞ –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è</h2>
                <p class="form-subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É, —á—Ç–æ–±—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–ª—É–±—É</p>

                <div class="success-message" id="successMessage">
                    ‚úÖ –°–ø–∞—Å–∏–±–æ! –í–∞—à–∞ –∞–Ω–∫–µ—Ç–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –û–∂–∏–¥–∞–π—Ç–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è!
                </div>

                <div class="error-message" id="errorMessage"></div>

                <form id="surveyForm">
                    <div class="form-group">
                        <label>–í–∞—à–µ –∏–º—è <span class="required">*</span></label>
                        <input type="text" id="name" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" required>
                    </div>

                    <div class="form-group">
                        <label>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è <span class="required">*</span></label>
                        <input type="date" id="birthDate" required>
                    </div>

                    <div class="form-group">
                        <label>Telegram @ <span class="required">*</span></label>
                        <input type="text" id="telegram" placeholder="username (–±–µ–∑ @)" required>
                    </div>

                    <div class="form-group">
                        <label>–°–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ <span class="required">*</span></label>
                        <select id="maritalStatus" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
                            <option value="—Å–≤–æ–±–æ–¥–Ω–∞">–°–≤–æ–±–æ–¥–Ω–∞</option>
                            <option value="–∑–∞–º—É–∂–µ–º">–ó–∞–º—É–∂–µ–º</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–î–µ—Ç–∏ (–≤–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª)</label>
                        <textarea id="children" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¥–æ—á—å, 7 –ª–µ—Ç; —Å—ã–Ω, 3 –≥–æ–¥–∞"></textarea>
                    </div>

                    <div class="form-group">
                        <label>–£–≤–ª–µ—á–µ–Ω–∏—è –∏ —Ö–æ–±–±–∏ <span class="required">*</span></label>
                        <textarea id="hobbies" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–∞—Ö..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label>–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ç–µ–º—ã <span class="required">*</span></label>
                        <textarea id="topics" placeholder="–ö–∞–∫–∏–µ –≤—Å—Ç—Ä–µ—á–∏ –∏ —Ç–µ–º—ã –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã?" required></textarea>
                    </div>

                    <div class="form-group">
                        <label>–¶–µ–ª—å –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è <span class="required">*</span></label>
                        <textarea id="goal" placeholder="–ü–æ—á–µ–º—É –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è?" required></textarea>
                    </div>

                    <div class="form-group">
                        <label>–û—Ç–∫—É–¥–∞ —É–∑–Ω–∞–ª–∏ –æ –∫–ª—É–±–µ? <span class="required">*</span></label>
                        <input type="text" id="source" placeholder="–ò–º—è –ø–æ–¥—Ä—É–≥–∏" required>
                    </div>

                    <div class="form-group">
                        <label><input type="checkbox" id="agreement" required> –Ø —Å–æ–≥–ª–∞—Å–Ω–∞ –ø–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ Telegram-—á–∞—Ç –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —Å–æ–æ–±—â–µ—Å—Ç–≤—É</label>
                    </div>

                    <div class="form-buttons">
                        <button type="reset" class="btn-reset">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                        <button type="submit" class="btn-submit" id="submitBtn">üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <footer>
        <p>¬© 2026 –ö–ª—É–± –≤–µ–¥—å–º "–í–µ–¥—å–º—ã –Ω–µ —Å—Ç–∞—Ä–µ—é—Ç" üßô‚Äç‚ôÄÔ∏è‚ú®</p>
    </footer>

    <script>
        async function loadMembers() {
            try {
                const response = await fetch('/api/members');
                const data = await response.json();
                
                console.log('üìä API Response:', data);
                
                const members = data.members || [];
                
                const container = document.getElementById('membersContainer');
                
                if (members.length === 0) {
                    container.innerHTML = '<div style="text-align: center; color: #aaa; grid-column: 1 / -1;">–£—á–∞—Å—Ç–Ω–∏—Ü –ø–æ–∫–∞ –Ω–µ—Ç</div>';
                    return;
                }
                
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${members.length} —É—á–∞—Å—Ç–Ω–∏—Ü`);
                
                container.innerHTML = members.map(member => `
                    <div class="member-card">
                        <div class="member-emoji">${member.emoji}</div>
                        <div class="member-name">${member.name}</div>
                        <div class="member-title">${member.title}</div>
                        ${member.bio ? `<div class="member-bio">${member.bio}</div>` : ''}
                    </div>
                `).join('');
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É—á–∞—Å—Ç–Ω–∏—Ü:', error);
                document.getElementById('membersContainer').innerHTML = '<div style="text-align: center; color: #FF6B6B; grid-column: 1 / -1;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ üò¢</div>';
            }
        }

        function toggleForm() {
            const formSection = document.getElementById('formSection');
            const toggleBtn = document.getElementById('toggleFormBtn');
            
            formSection.classList.toggle('form-hidden');
            
            if (!formSection.classList.contains('form-hidden')) {
                toggleBtn.textContent = 'üìù –ó–∞–∫—Ä—ã—Ç—å –∞–Ω–∫–µ—Ç—É';
                formSection.scrollIntoView({ behavior: 'smooth' });
            } else {
                toggleBtn.textContent = 'üìù –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∞–Ω–∫–µ—Ç—É';
            }
        }

        function scrollToForm() {
            const formSection = document.getElementById('formSection');
            formSection.classList.remove('form-hidden');
            document.getElementById('toggleFormBtn').textContent = 'üìù –ó–∞–∫—Ä—ã—Ç—å –∞–Ω–∫–µ—Ç—É';
            formSection.scrollIntoView({ behavior: 'smooth' });
        }

        document.getElementById('surveyForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const submitBtn = document.getElementById('submitBtn');
            const successMsg = document.getElementById('successMessage');
            const errorMsg = document.getElementById('errorMessage');

            successMsg.style.display = 'none';
            errorMsg.style.display = 'none';

            const data = {
                name: document.getElementById('name').value.trim(),
                birth_date: document.getElementById('birthDate').value,
                telegram: document.getElementById('telegram').value.trim().replace('@', ''),
                about: `–•–æ–±–±–∏: ${document.getElementById('hobbies').value.trim()}\n\n–¢–µ–º—ã: ${document.getElementById('topics').value.trim()}\n\n–¶–µ–ª—å: ${document.getElementById('goal').value.trim()}\n\n–û—Ç–∫—É–¥–∞ —É–∑–Ω–∞–ª–∞: ${document.getElementById('source').value.trim()}`
            };

            if (!data.name || !data.birth_date || !data.telegram) {
                errorMsg.textContent = '‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!';
                errorMsg.style.display = 'block';
                return;
            }

            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–ª—è—é...';

            try {
                const response = await fetch('/api/survey', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                console.log('üìä Response:', result);

                if (response.status === 201 || result.status === 'success') {
                    successMsg.style.display = 'block';
                    document.getElementById('surveyForm').reset();
                    
                    setTimeout(() => {
                        loadMembers();
                        toggleForm();
                    }, 1000);
                } else {
                    errorMsg.textContent = '‚ùå –û—à–∏–±–∫–∞: ' + (result.error || '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞');
                    errorMsg.style.display = 'block';
                }
            } catch (error) {
                console.error('‚ùå Fetch error:', error);
                errorMsg.textContent = '‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ' + error.message;
                errorMsg.style.display = 'block';
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å';
            }
        });

        loadMembers();
    </script>
</body>
</html>
